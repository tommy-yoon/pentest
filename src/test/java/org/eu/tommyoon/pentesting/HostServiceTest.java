package org.eu.tommyoon.pentesting;

import static org.junit.Assert.*;
import static org.mockito.Mockito.*;

import org.eu.tommyoon.pentesting.host.Host;
import org.eu.tommyoon.pentesting.host.HostService;
import org.junit.Test;

public class HostServiceTest {

	@Test
	public void getTTL() {
		
		HostService hostService = new HostService(); 

        // Replace with the IP address you want to test
        String ip = "192.168.137.3";

        Integer ttl = hostService.getTTL(ip);

        // You should adjust these assertions based on your specific requirements
        assertNotNull(ttl);
        assertTrue(ttl >= 0 && ttl <= 255);
        
//		fail("Not yet implemented");
	}
	
	@Test
	public void guessOS() {
//		HostService hostService = new HostService(); 
		
		// Mock the getTTL method
		HostService osGuessMock = mock(HostService.class);
        when(osGuessMock.getTTL(anyString())).thenReturn(127); // Mock the TTL value

        // Test the guessOS method using the mocked getTTL method
        String result = osGuessMock.guessOS("192.168.137.3");

        // Verify the result
        assertNotNull(result);
        assertEquals("Windows", result);

        // Test the guessOS method using the mocked getTTL method
        when(osGuessMock.getTTL(anyString())).thenReturn(64); // Mock the TTL value
        result = osGuessMock.guessOS("192.168.137.4");
        
        // Verify the result
        assertNotNull(result);
        assertEquals("Linux/Unix", result);
	}
	
	@Test
	public void scan() throws Exception {
		HostService hostService = new HostService(); 
		
		hostService.scan("192.168.137.3", 24);
		
		Host host = hostService.getHosts().get(0);
		
		assertTrue(host.getOs().equals("Windows"));
	}

}
