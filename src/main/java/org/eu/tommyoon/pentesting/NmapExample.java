package org.eu.tommyoon.pentesting;

import org.nmap4j.Nmap4j;
import org.nmap4j.data.NMapRun;
import org.nmap4j.parser.OnePassParser;

public class NmapExample {
    public static void main(String[] args) {
    	String targetIPRange = "192.168.137.3-5";
        Nmap4j nmap4j = new Nmap4j("."); // Path to the Nmap executable
//        nmap4j.addFlags("-T4"); // Specify Nmap scan options
        nmap4j.addFlags("-F -O"); // Specify Nmap scan options
        nmap4j.includeHosts(targetIPRange); // Host or IP address to scan

        try {
            nmap4j.execute(); // Execute the Nmap scan

            if (nmap4j.hasError()) {
                System.out.println("Error: " + nmap4j.getExecutionResults().getErrors());
            } else {
                System.out.println("Nmap Output:\n" + nmap4j.getOutput());
                
                
                NMapRun nmapRun = nmap4j.getResult();
//                System.out.println("Nmap Output:\n" + nmapRun);
//                System.out.println("Nmap hosts:\n" + nmapRun.getHosts());
            	
//            	OnePassParser parser = new OnePassParser();
//                NMapRun nmapRun = parser.parse(nmap4j.getOutput(), OnePassParser.STRING_INPUT);
//
//                // Access scan results
//                for (org.nmap4j.data.nmaprun.Host host : nmapRun.getHosts()) {
//                    System.out.println("IP Address: " + host.getAddresses().get(0));
//                    System.out.println("OS Detected: " + host.getOs().getOsMatches().get(0).getName());
//                    System.out.println("Open Ports: " + host.getPorts());
//                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
