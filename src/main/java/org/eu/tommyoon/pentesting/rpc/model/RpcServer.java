
package org.eu.tommyoon.pentesting.rpc.model;

import org.eu.tommyoon.pentesting.rpc.RpcConnection;

public class RpcServer extends SavedRpcServer {

    public static final int STATUS_NEW = 0;
    public static final int STATUS_CONNECTING = 1;
    public static final int STATUS_CONNECTION_FAILED = 2;
    public static final int STATUS_AUTHORISED = 3;
    public static final int STATUS_CONNECTED = 4;
    public static final int STATUS_AUTHORISATION_FAILED = 5;

    public int status;
    public String rpcPassword;
    public RpcConnection rpcConnection;
    
    public RpcServer(String name, boolean ssl, String rpcHost, String rpcUser, String rpcPassword, int rpcPort) {
		super(name, ssl, rpcHost, rpcUser, rpcPort);
		this.rpcPassword = rpcPassword;
	}

	public String getRpcPassword() {
		return rpcPassword;
	}

	public void setRpcPassword(String rpcPassword) {
		this.rpcPassword = rpcPassword;
	}

	public String getStatusString() {
        if (status == RpcServer.STATUS_NEW) {
            return " ";
        } else if (status == RpcServer.STATUS_CONNECTING) {
            return "Connectingâ€¦";
        } else if (status == RpcServer.STATUS_AUTHORISED) {
            return "Authorised";
        } else if (status == RpcServer.STATUS_CONNECTED) {
            return "Connected";
        } else if (status == RpcServer.STATUS_CONNECTION_FAILED) {
            return "Connection failed";
        } else {
            return "Connection failed";
        }
    }

    public RpcConnection getRpc() {
        return rpcConnection;
    }

    public MsfModel getModel() {
        return rpcConnection.getModel();
    }

}
