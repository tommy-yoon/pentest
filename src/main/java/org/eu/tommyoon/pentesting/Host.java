package org.eu.tommyoon.pentesting;

import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

import jakarta.annotation.Nonnull;
import lombok.Data;

@Data
public class Host {
	@Nonnull
	private int id;
	@Nonnull
	private String ip;
	private List<Integer> openPorts = new ArrayList<Integer>();
	private String os;
	private HostStatus status;

	@Override
	public String toString() {
		return "[Host details]\n" + "index: " + id + "\n" + "IP: " + ip + "\n" + "os: " + os + "\n" + "status: "
				+ status + "\n" + "OpenPorts: <typical usage>\n" + createOpenPortsLines() + "";
	}

	private String createOpenPortsLines() {
		String result = "";

		int index = 0;
//		int numberOfSpaces = 40;
		for (Integer integer : openPorts) {
			result += "\t" + String.valueOf(integer) + ": " + getPortMap(integer);
			index++;
//			if (index % 2 == 0 ) {
//				result += "\n";
//			} else {
////				for (int i = 0; i < numberOfSpaces - result.length(); i++) {
////			        result.concat(" ");
////			    }
//				result+="\t\t\t\t";
//			}
			if (index < openPorts.size()) {
				result += "\n";
			}
		}

		return result;
	}

	private String getPortMap(Integer port) {
		switch (port) {
		case 80:
			return "HTTP";
		case 443:
			return "HTTPS";
		case 13:
			return "Daytime Protocol";
		case 20:
		case 21:
			return "FTP";
		case 22:
			return "SSH";
		case 23:
			return "Telnet";
		case 25:
			return "SMTP";
		case 53:
			return "DNS";
		case 110:
			return "POP3";
		case 143:
			return "IMAP";
		case 161:
		case 162:
			return "SNMP";
		case 3389:
			return "RDP";
		case 3306:
			return "MySQL";
		case 5432:
			return "PostgreSQL";
		case 1521:
			return "Oracle";
		case 445:
			return "SMB";
		case 123:
			return "NTP";
		default:
			return "";
		}
	}

	public void sortPortsByPortNo() {
		openPorts = openPorts.stream().sorted((portA, portB) -> portA.compareTo(portB)).collect(Collectors.toList());
	}
}